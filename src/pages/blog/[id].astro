---
import type { GetStaticPaths } from "astro"
import { getCollection, render } from "astro:content"

import BaseLayout from "../../layouts/BaseLayout.astro"
import MainLayout from "../../layouts/MainLayout.astro"
import Panel from "../../components/Panel.astro"

export const getStaticPaths = (async () => {
  const blogs = await getCollection("blog", ({ data }) => data.publish === true)

  return blogs.map((blog) => ({
    params: { id: blog.id },
    props: { blog }
  }))
}) satisfies GetStaticPaths

const { blog } = Astro.props
const { Content } = await render(blog)
---

<BaseLayout title={blog.data.title} description={blog.data.description}>
  <MainLayout>
    <Panel>
      <h1>{blog.data.title}</h1>

      <Content />
    </Panel>
  </MainLayout>
</BaseLayout>
